# railway.toml
# ------------------------------
# ✅ Railway Build Config cho NestJS 11 + PostgreSQL + TypeORM
# ------------------------------

[build]
builder = "Nixpacks"

# ⚙️ Build command (legacy-peer-deps được xử lý bởi .npmrc)
buildCommand = "npm ci && npm run build"

# (Tuỳ chọn) Nếu bạn muốn tự chạy migration mỗi lần build:
# buildCommand = "npm install --legacy-peer-deps && npm run build && npm run migration:run"

[deploy]
# ⚙️ Lệnh start app
startCommand = "npm run start:prod"

# (Không cần restartPolicyType nữa — Railway đã loại bỏ)
# restartPolicyType = "on-failure"

# (Tuỳ chọn) Port
port = 3000

[variables]
NODE_ENV = "production"
PORT = "3000"
